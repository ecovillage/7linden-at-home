#!/bin/bash
# Copyright 2015, 2016 Felix Wolfsteller
# Released under the GPL

# Check whether our gateway is 7 Linden router
# Return 0 if at home.

set -e

readonly CP_HOST="192.168.0.1"

am_at_home() {
  /usr/bin/ssh-keyscan -T1 "$CP_HOST" 2> /dev/null | sort | diff /opt/7linden-at-home/data/host_keys -
}

main() {
  if am_at_home; then
    # Post login info
    exit 0
  else
    #  ; # Nothing to do
    echo "Not at home"
    exit 1
  fi
}

main
